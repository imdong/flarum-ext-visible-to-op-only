(()=>{var o={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},d:(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},t={};(()=>{"use strict";o.r(t),o.d(t,{extPrefix:()=>n,key:()=>s,trans:()=>i});const e=flarum.core.compat["common/app"];var r=o.n(e),n="imdong-visible-to-op-only";function s(o){return n+"."+o.replace(/^\.*/,"")}function i(o,t){return void 0===t&&(t={}),r().translator.trans(s(o),t)}const a=flarum.core.compat["forum/app"];var c=o.n(a);const p=flarum.core.compat["common/extend"],u=flarum.core.compat["forum/components/ReplyComposer"];var l=o.n(u);const d=flarum.core.compat["common/models/Post"];var f=o.n(d);function y(o,t,e){return o.replace(/<onlyopsee>([\s\S]*?)<\/onlyopsee>/gi,(function(o,r){return b(t,r,e)}))}function b(o,t,e){var r=i(o?"forum.only_op_see":"forum.hidden_content_only_op_see");return!app.session.user.attribute("canVisibleToOpPermissionsViewButton")&&e?""+(t||""):'<div class="onlyopsee" data-title-content="'+r+'" >'+(t||"")+"</div>"}const v=flarum.core.compat["common/components/TextEditor"];var _=o.n(v);const P=flarum.core.compat["common/components/TextEditorButton"];var O=o.n(P);const x=flarum.core.compat["common/utils/styleSelectedText"];var T=o.n(x),h={prefix:"[OP]",suffix:"[/OP]",trimFirst:!0};c().initializers.add(n,(function(){(0,p.extend)(_().prototype,"toolbarItems",(function(o){var t=this;app.session.user.attribute("canVisibleToOpPermissionsViewButton")&&(app.composer.body.attrs.discussion||app.composer.body.attrs.post)&&o.add("only-op-see",m(O(),{onclick:function(){return T()(t.attrs.composer.editor.el,h)},icon:"fas fa-user-shield"},i("forum.button_tooltip_only_op_see")))})),(0,p.override)(f().prototype,"contentHtml",(function(o,t){return this.attribute("canViewPosts")?(this.attribute("canVisibleToOpPermissionsViewButton"),y(o(),this.attribute("canViewHidePosts"),!1)):b(!1,!1)})),(0,p.override)(s9e.TextFormatter,"preview",(function(o,t,e){o(t,e),e.innerHTML=y(e.innerHTML,!0,!0)})),(0,p.override)(l().prototype,"onsubmit",(function(o,t){if(/\[OP\]\s*\[\/OP\]/.test(t))return c().alerts.show({type:"error"},i("forum.editor_empty_tips")),!1;o()}))}))})(),module.exports=t})();
//# sourceMappingURL=forum.js.map